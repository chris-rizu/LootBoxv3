<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LootBox Shopping Cart - Review your premium PC parts and peripherals">
    <title>Shopping Cart - LootBox</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ==================== BASE STYLES ==================== */
        * { box-sizing: border-box; }
        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4f46e5; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6366f1; }
        html { scrollbar-width: thin; scrollbar-color: #4f46e5 #1f2937; }

        /* ==================== ANIMATED BACKGROUND ==================== */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            overflow: hidden;
            background: #030712;
        }
        .animated-bg::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(ellipse at 20% 80%, rgba(79, 70, 229, 0.15) 0%, transparent 50%),
                        radial-gradient(ellipse at 80% 20%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
                        radial-gradient(ellipse at 40% 40%, rgba(6, 182, 212, 0.08) 0%, transparent 40%);
            animation: bgFloat 20s ease-in-out infinite;
        }
        .animated-bg::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234f46e5' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }
        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(2%, 2%) rotate(1deg); }
            66% { transform: translate(-1%, 1%) rotate(-1deg); }
        }

        /* ==================== FLOATING PARTICLES ==================== */
        .particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(99, 102, 241, 0.6);
            border-radius: 50%;
            animation: floatParticle 15s infinite ease-in-out;
        }
        .particle:nth-child(odd) { background: rgba(212, 175, 55, 0.4); }
        .particle:nth-child(3n) { background: rgba(6, 182, 212, 0.5); }
        @keyframes floatParticle {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }

        /* ==================== FOCUS STATES FOR ACCESSIBILITY ==================== */
        *:focus { outline: none; }
        *:focus-visible { outline: 2px solid #6366f1; outline-offset: 2px; }

        /* Skip link for screen readers */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #4f46e5;
            color: white;
            padding: 8px 16px;
            z-index: 100;
            transition: top 0.3s;
            border-radius: 0 0 8px 0;
        }
        .skip-link:focus { top: 0; }

        /* ==================== CONFETTI CANVAS ==================== */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* ==================== ENHANCED CARD STYLES ==================== */
        .cart-card {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.9) 0%, rgba(18, 18, 26, 0.95) 100%);
            border: 1px solid transparent;
            background-clip: padding-box;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
        }
        .cart-card.loaded { opacity: 1; }
        .cart-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.3), rgba(139, 92, 246, 0.3), rgba(255, 0, 255, 0.2));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.5;
            transition: opacity 0.4s ease;
            animation: borderGlow 4s ease-in-out infinite;
        }
        .cart-card:hover::before { opacity: 1; }
        .cart-card:hover {
            transform: translateY(-4px) scale(1.01);
            box-shadow: 0 20px 60px rgba(0, 240, 255, 0.2), 0 0 40px rgba(139, 92, 246, 0.15);
        }
        @keyframes borderGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 0.8; }
        }

        /* Card bounce animation */
        .cart-card.bounce {
            animation: cardBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes cardBounce {
            0% { transform: scale(1); }
            30% { transform: scale(1.05); }
            50% { transform: scale(0.95); }
            70% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* Summary Card with glow pulse */
        .summary-card {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.95) 0%, rgba(18, 18, 26, 0.98) 100%);
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
        }
        .summary-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.4), rgba(139, 92, 246, 0.4), rgba(255, 0, 255, 0.3));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            animation: summaryGlow 3s ease-in-out infinite;
        }
        .summary-card::after {
            content: '';
            position: absolute;
            top: -100%;
            left: -100%;
            width: 300%;
            height: 300%;
            background: conic-gradient(from 0deg, transparent, rgba(99, 102, 241, 0.1), transparent 30%);
            animation: rotateBg 8s linear infinite;
            pointer-events: none;
        }
        @keyframes summaryGlow {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        @keyframes rotateBg {
            100% { transform: rotate(360deg); }
        }

        /* ==================== BUTTON STYLES ==================== */
        .btn-glow {
            background: linear-gradient(135deg, #4f46e5, #6366f1, #8b5cf6, #a855f7);
            background-size: 300% 300%;
            animation: gradientShift 4s ease infinite, buttonPulse 2s ease-in-out infinite;
            color: white;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
        }
        .btn-glow::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s ease;
        }
        .btn-glow::after {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(135deg, #00f0ff, #8b5cf6, #ff00ff, #00f0ff);
            background-size: 400% 400%;
            border-radius: inherit;
            z-index: -1;
            animation: gradientBorder 3s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .btn-glow:hover::before { left: 100%; }
        .btn-glow:hover::after { opacity: 1; }
        .btn-glow:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 40px rgba(79, 70, 229, 0.5), 0 0 30px rgba(139, 92, 246, 0.4);
        }
        .btn-glow:active {
            transform: translateY(0) scale(0.98);
            animation: buttonClick 0.2s ease;
        }
        @keyframes buttonPulse {
            0%, 100% { box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3); }
            50% { box-shadow: 0 4px 25px rgba(79, 70, 229, 0.5); }
        }
        @keyframes gradientBorder {
            0% { background-position: 0% 50%; }
            100% { background-position: 400% 50%; }
        }
        @keyframes buttonClick {
            50% { transform: scale(0.95); }
        }
        .btn-glow:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        .btn-glow:disabled::before { display: none; }

        /* Secondary Button with ripple */
        .btn-secondary {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #e5e7eb;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        .btn-secondary:hover {
            background: rgba(55, 65, 81, 0.9);
            border-color: rgba(99, 102, 241, 0.6);
            color: white;
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
        }
        .btn-secondary:active { transform: scale(0.98); }

        /* Quantity Buttons with pop effect */
        .qty-btn {
            background: linear-gradient(145deg, rgba(79, 70, 229, 0.15), rgba(99, 102, 241, 0.15));
            border: 1px solid rgba(99, 102, 241, 0.3);
            transition: all 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }
        .qty-btn:hover {
            background: linear-gradient(145deg, rgba(79, 70, 229, 0.4), rgba(99, 102, 241, 0.4));
            border-color: rgba(99, 102, 241, 0.8);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.4), inset 0 0 10px rgba(99, 102, 241, 0.1);
            transform: scale(1.1);
        }
        .qty-btn:active {
            transform: scale(0.85);
            transition: transform 0.1s ease;
        }
        .qty-btn.pop {
            animation: qtyPop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes qtyPop {
            0% { transform: scale(1); }
            40% { transform: scale(1.3); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        .qty-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none !important; }

        /* Delete Button with shake */
        .btn-delete {
            color: #ef4444;
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            position: relative;
        }
        .btn-delete:hover {
            color: #f87171;
            background: rgba(239, 68, 68, 0.15);
            transform: scale(1.15) rotate(-5deg);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.3);
        }
        .btn-delete:active { transform: scale(0.9) rotate(0deg); }

        /* Ripple effect for buttons */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.4);
            transform: scale(0);
            animation: rippleEffect 0.6s linear;
            pointer-events: none;
        }
        @keyframes rippleEffect {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* ==================== TEXT STYLES ==================== */
        .price-glow {
            color: #d4af37;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
            animation: priceGlow 2s ease-in-out infinite alternate;
        }
        @keyframes priceGlow {
            0% { text-shadow: 0 0 10px rgba(212, 175, 55, 0.3); }
            100% { text-shadow: 0 0 20px rgba(212, 175, 55, 0.5), 0 0 30px rgba(212, 175, 55, 0.3); }
        }
        .text-gradient {
            background: linear-gradient(135deg, #d4af37, #f0d68a, #ffd700, #d4af37);
            background-size: 300% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmerText 3s linear infinite;
        }
        .line-total {
            color: #10b981;
            font-weight: 600;
            text-shadow: 0 0 8px rgba(16, 185, 129, 0.3);
        }

        /* ==================== PRODUCT BADGES ==================== */
        .badge {
            font-size: 10px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: badgePulse 2s ease-in-out infinite;
        }
        .badge-popular {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: #000;
        }
        .badge-bestseller {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: #000;
        }
        .badge-limited {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: #fff;
        }
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ==================== SAVINGS DISPLAY ==================== */
        .savings-display {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.1));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: savingsGlow 2s ease-in-out infinite;
        }
        .savings-display.hidden { display: none; }
        @keyframes savingsGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(16, 185, 129, 0.1); }
            50% { box-shadow: 0 0 25px rgba(16, 185, 129, 0.3); }
        }

        /* ==================== PROGRESS BAR ==================== */
        .progress-container {
            background: rgba(31, 41, 55, 0.6);
            border-radius: 999px;
            height: 8px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #8b5cf6, #a855f7);
            background-size: 200% 100%;
            animation: progressShimmer 2s linear infinite;
            border-radius: 999px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .progress-bar.complete {
            background: linear-gradient(90deg, #10b981, #34d399, #10b981);
        }
        @keyframes progressShimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* ==================== CART VALUE METER ==================== */
        .cart-meter {
            background: linear-gradient(145deg, rgba(26, 26, 46, 0.8), rgba(18, 18, 26, 0.9));
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 20px;
        }
        .meter-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #00f0ff, #8b5cf6, #ff00ff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmerText 3s linear infinite;
        }

        /* ==================== IMAGE ZOOM EFFECT ==================== */
        .img-zoom-container {
            overflow: hidden;
            border-radius: 12px;
            position: relative;
        }
        .img-zoom-container::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        .cart-card:hover .img-zoom-container::after {
            transform: translateX(100%);
        }
        .cart-img {
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .cart-card:hover .cart-img {
            transform: scale(1.1) rotate(2deg);
        }

        /* ==================== ANIMATIONS ==================== */
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        @keyframes shimmerText {
            0% { background-position: 0% center; }
            100% { background-position: 300% center; }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            20% { transform: translateX(-8px) rotate(-3deg); }
            40% { transform: translateX(8px) rotate(3deg); }
            60% { transform: translateX(-6px) rotate(-2deg); }
            80% { transform: translateX(6px) rotate(2deg); }
        }
        @keyframes cartShake {
            0%, 100% { transform: rotate(0deg); }
            10% { transform: rotate(10deg); }
            20% { transform: rotate(-10deg); }
            30% { transform: rotate(8deg); }
            40% { transform: rotate(-8deg); }
            50% { transform: rotate(5deg); }
            60% { transform: rotate(-5deg); }
            70% { transform: rotate(3deg); }
            80% { transform: rotate(-3deg); }
            90% { transform: rotate(1deg); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes countUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-fade-in { animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        .animate-slide-in { animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        .animate-slide-up { animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        .animate-bounce { animation: bounce 0.5s ease-in-out; }
        .animate-shake { animation: shake 0.6s ease-in-out; }
        .cart-item {
            animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
        }
        .cart-item:nth-child(1) { animation-delay: 0.05s; }
        .cart-item:nth-child(2) { animation-delay: 0.1s; }
        .cart-item:nth-child(3) { animation-delay: 0.15s; }
        .cart-item:nth-child(4) { animation-delay: 0.2s; }
        .cart-item:nth-child(5) { animation-delay: 0.25s; }
        .cart-item:nth-child(6) { animation-delay: 0.3s; }

        /* ==================== LOADING SKELETON ==================== */
        .skeleton {
            background: linear-gradient(90deg, rgba(31, 41, 55, 0.6) 25%, rgba(55, 65, 81, 0.6) 50%, rgba(31, 41, 55, 0.6) 75%);
            background-size: 200% 100%;
            animation: skeletonPulse 1.5s ease-in-out infinite;
            border-radius: 8px;
        }
        @keyframes skeletonPulse {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        .skeleton-card {
            background: rgba(26, 26, 46, 0.5);
            border: 1px solid rgba(99, 102, 241, 0.1);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            gap: 16px;
        }
        .skeleton-img { width: 100px; height: 100px; flex-shrink: 0; }
        .skeleton-text { height: 16px; margin-bottom: 8px; }
        .skeleton-text.short { width: 60%; }
        .skeleton-text.medium { width: 80%; }
        .skeleton-price { height: 24px; width: 100px; }

        /* ==================== TOAST NOTIFICATION ENHANCED ==================== */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .toast {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.98), rgba(18, 18, 26, 0.99));
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            padding: 16px 20px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4), 0 0 30px rgba(99, 102, 241, 0.1);
            animation: toastSlideIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
            backdrop-filter: blur(10px);
        }
        .toast-icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: iconPop 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) 0.2s forwards;
            transform: scale(0);
        }
        .toast.success .toast-icon { background: linear-gradient(135deg, #10b981, #34d399); }
        .toast.error .toast-icon { background: linear-gradient(135deg, #ef4444, #f87171); }
        .toast.info .toast-icon { background: linear-gradient(135deg, #6366f1, #8b5cf6); }
        .toast.success { border-color: rgba(16, 185, 129, 0.5); }
        .toast.error { border-color: rgba(239, 68, 68, 0.5); }
        .toast.info { border-color: rgba(99, 102, 241, 0.5); }
        .toast-content { flex: 1; }
        .toast-title { font-weight: 600; margin-bottom: 2px; }
        .toast-message { font-size: 13px; color: #9ca3af; }
        .toast-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 0 0 16px 16px;
            animation: toastProgress 3s linear forwards;
        }
        .toast.success .toast-progress { background: linear-gradient(90deg, #10b981, #34d399); }
        .toast.error .toast-progress { background: linear-gradient(90deg, #ef4444, #f87171); }
        @keyframes toastSlideIn {
            from { opacity: 0; transform: translateX(100%) scale(0.8); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }
        @keyframes toastSlideOut {
            from { opacity: 1; transform: translateX(0) scale(1); }
            to { opacity: 0; transform: translateX(100%) scale(0.8); }
        }
        @keyframes iconPop {
            from { transform: scale(0) rotate(-180deg); }
            to { transform: scale(1) rotate(0deg); }
        }
        @keyframes toastProgress {
            from { width: 100%; }
            to { width: 0%; }
        }
        .toast.exit { animation: toastSlideOut 0.4s cubic-bezier(0.4, 0, 1, 1) forwards; }

        /* ==================== FORM INPUTS ==================== */
        .promo-input {
            background: rgba(31, 41, 55, 0.6);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 8px;
            padding: 10px 14px;
            color: white;
            transition: all 0.3s ease;
            width: 100%;
        }
        .promo-input:focus {
            border-color: rgba(99, 102, 241, 0.6);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        .promo-input::placeholder { color: #6b7280; }

        /* Quantity Input */
        .qty-input {
            -moz-appearance: textfield;
            appearance: textfield;
        }
        .qty-input::-webkit-outer-spin-button,
        .qty-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* ==================== CART HEADER INFO ==================== */
        .cart-header-info {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(99, 102, 241, 0.05));
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 24px;
        }

        /* ==================== TEXT UTILITIES ==================== */
        .line-clamp-1 {
            display: -webkit-box;
            -webkit-line-clamp: 1;
            line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* ==================== MOBILE STICKY CHECKOUT ==================== */
        .mobile-checkout-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(17, 24, 39, 0.98) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid rgba(99, 102, 241, 0.2);
            padding: 12px 16px;
            z-index: 40;
            display: none;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

        /* ==================== RESPONSIVE STYLES ==================== */
        /* Tablet (768px and below) */
        @media (max-width: 768px) {
            .cart-card { padding: 16px !important; }
            .summary-card { margin-top: 24px; }
            .toast {
                min-width: auto;
                max-width: calc(100vw - 32px);
                right: 16px;
                left: 16px;
                margin: 0 auto;
            }
            .toast-container {
                top: 80px;
                right: 0;
                left: 0;
                padding: 0 16px;
            }
            /* Disable hover effects on touch */
            .cart-card:hover {
                transform: none;
                box-shadow: none;
            }
            .cart-card:hover::before { opacity: 0.5; }
        }

        /* Mobile (640px and below) */
        @media (max-width: 640px) {
            /* Touch-friendly buttons - minimum 44px */
            .qty-btn {
                width: 44px !important;
                height: 44px !important;
                font-size: 18px !important;
            }
            .btn-delete {
                min-width: 44px;
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            .btn-secondary {
                min-height: 44px;
                padding: 10px 16px !important;
            }
            .btn-glow {
                min-height: 48px;
            }
            .promo-input {
                min-height: 44px;
                font-size: 16px; /* Prevents zoom on iOS */
            }
            .cart-img {
                width: 72px !important;
                height: 72px !important;
            }
            /* Show mobile checkout bar */
            .mobile-checkout-bar { display: block; }
            /* Add padding to main content for mobile checkout bar */
            main { padding-bottom: 100px !important; }
            /* Hide desktop checkout button */
            #checkout-btn.desktop-only { display: none; }
            /* Footer links touch-friendly */
            footer a {
                padding: 10px 0;
                display: inline-block;
            }
            /* Quantity input */
            .qty-input {
                width: 48px !important;
                height: 44px !important;
                font-size: 16px !important;
            }
            /* Breadcrumb smaller */
            nav[aria-label="Breadcrumb"] {
                font-size: 12px;
            }
        }

        /* Extra small screens (320px - 375px) */
        @media (max-width: 375px) {
            .container { padding-left: 12px !important; padding-right: 12px !important; }
            .cart-card { padding: 12px !important; }
            .cart-img {
                width: 60px !important;
                height: 60px !important;
            }
            .qty-btn {
                width: 40px !important;
                height: 40px !important;
            }
            h1 { font-size: 1.375rem !important; }
            .summary-card { padding: 16px !important; }
            .price-glow { font-size: 14px; }
            .line-total { font-size: 14px; }
            /* Stack promo code on tiny screens */
            .promo-flex {
                flex-direction: column;
            }
            .promo-flex button {
                width: 100%;
                margin-top: 8px;
            }
        }

        /* Large screens - enhance grid */
        @media (min-width: 1280px) {
            .cart-card { padding: 24px !important; }
            .cart-img {
                width: 120px !important;
                height: 120px !important;
            }
        }

        /* ==================== TOUCH DEVICE OPTIMIZATIONS ==================== */
        @media (hover: none) and (pointer: coarse) {
            /* Disable hover transforms on touch devices */
            .cart-card:hover {
                transform: none;
            }
            .btn-glow:hover {
                transform: none;
            }
            .qty-btn:hover {
                box-shadow: none;
            }
            /* Make buttons easier to tap */
            button, a {
                -webkit-tap-highlight-color: rgba(99, 102, 241, 0.2);
            }
        }

        /* ==================== REDUCED MOTION ==================== */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
            .cart-item {
                animation: none !important;
            }
        }

        /* ==================== HIGH CONTRAST MODE ==================== */
        @media (prefers-contrast: high) {
            .cart-card, .summary-card {
                border: 2px solid #6366f1 !important;
            }
            .btn-glow {
                border: 2px solid white;
            }
            .price-glow {
                color: #fbbf24;
                text-shadow: none;
            }
        }

        /* ==================== PRINT STYLES ==================== */
        @media print {
            .toast-container, .skip-link, .mobile-checkout-bar,
            header, footer, .btn-delete, .qty-btn { display: none !important; }
            body { background: white !important; color: black !important; }
            .cart-card, .summary-card {
                background: white !important;
                border: 1px solid #ccc !important;
                box-shadow: none !important;
            }
            .price-glow, .line-total, .text-gradient {
                color: black !important;
                -webkit-text-fill-color: black !important;
                text-shadow: none !important;
            }
        }

        /* ==================== EMPTY CART ANIMATED ==================== */
        .empty-cart-icon {
            animation: emptyCartFloat 3s ease-in-out infinite;
        }
        @keyframes emptyCartFloat {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            25% { transform: translateY(-10px) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(5deg); }
            75% { transform: translateY(-15px) rotate(0deg); }
        }
        .empty-cart-sparkle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #d4af37;
            border-radius: 50%;
            animation: sparkle 2s ease-in-out infinite;
        }
        .empty-cart-sparkle:nth-child(1) { top: 10%; left: 20%; animation-delay: 0s; }
        .empty-cart-sparkle:nth-child(2) { top: 30%; right: 15%; animation-delay: 0.5s; }
        .empty-cart-sparkle:nth-child(3) { bottom: 20%; left: 10%; animation-delay: 1s; }
        .empty-cart-sparkle:nth-child(4) { bottom: 30%; right: 25%; animation-delay: 1.5s; }
        @keyframes sparkle {
            0%, 100% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1); opacity: 1; }
        }

        /* ==================== RECENTLY REMOVED ==================== */
        .recently-removed {
            background: linear-gradient(145deg, rgba(239, 68, 68, 0.05), rgba(239, 68, 68, 0.02));
            border: 1px dashed rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }
        .recently-removed.hidden { display: none; }
        .undo-btn {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #fca5a5;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .undo-btn:hover {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: white;
        }

        /* ==================== ESTIMATED DELIVERY ==================== */
        .delivery-date {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 10px;
        }
        .calendar-icon {
            animation: calendarBounce 2s ease-in-out infinite;
        }
        @keyframes calendarBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        /* ==================== RATING STARS ==================== */
        .stars {
            display: flex;
            gap: 2px;
        }
        .star {
            color: #fbbf24;
            font-size: 12px;
        }
        .star.empty { color: #374151; }

        /* ==================== SOUND TOGGLE ==================== */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(31, 41, 55, 0.9);
            border: 1px solid rgba(99, 102, 241, 0.3);
            color: #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 50;
        }
        .sound-toggle:hover {
            background: rgba(99, 102, 241, 0.2);
            color: white;
            transform: scale(1.1);
        }
        .sound-toggle.active { color: #10b981; }
        @media (max-width: 640px) {
            .sound-toggle { bottom: 120px; }
        }

        /* ==================== PRODUCT BADGES ==================== */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 3px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: badgePulse 2s ease-in-out infinite;
        }
        .badge-popular {
            background: linear-gradient(135deg, #f97316, #fb923c);
            color: white;
        }
        .badge-bestseller {
            background: linear-gradient(135deg, #eab308, #facc15);
            color: #1f2937;
        }
        .badge-limited {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: white;
        }
        @keyframes badgePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* ==================== SAVINGS DISPLAY ==================== */
        .savings-display {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.05));
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 12px;
            animation: savingsGlow 2s ease-in-out infinite;
        }
        @keyframes savingsGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(16, 185, 129, 0.1); }
            50% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
        }

        /* ==================== RIPPLE EFFECT ==================== */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0);
            animation: rippleEffect 0.6s linear;
            pointer-events: none;
        }
        @keyframes rippleEffect {
            to { transform: scale(4); opacity: 0; }
        }
        .btn-glow, .btn-secondary, .qty-btn {
            position: relative;
            overflow: hidden;
        }

        /* ==================== IMAGE ZOOM ==================== */
        .img-zoom-container {
            overflow: hidden;
            border-radius: 12px;
            background: rgba(31, 41, 55, 0.5);
        }
        .img-zoom-container img {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .img-zoom-container:hover img {
            transform: scale(1.15);
        }

        /* ==================== CART VALUE METER ==================== */
        .cart-meter {
            text-align: center;
            padding: 16px;
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(139, 92, 246, 0.05));
            border-radius: 12px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        .meter-value {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #8b5cf6, #d4af37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: meterPulse 2s ease-in-out infinite;
        }
        @keyframes meterPulse {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }

        /* ==================== SHIPPING PROGRESS ==================== */
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(31, 41, 55, 0.6);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 12px;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #8b5cf6, #a855f7);
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progressShimmer 2s linear infinite;
        }
        @keyframes progressShimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .progress-bar.complete {
            background: linear-gradient(90deg, #10b981, #34d399);
        }

        /* ==================== BOUNCE ANIMATION FOR CARDS ==================== */
        .cart-card.bounce {
            animation: cardBounce 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        @keyframes cardBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        .cart-card.loaded {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-950 text-gray-200 min-h-screen flex flex-col">
    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Floating Particles -->
    <div class="particles-container" id="particles" aria-hidden="true"></div>

    <!-- Confetti Canvas -->
    <canvas id="confetti-canvas" aria-hidden="true"></canvas>

    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Toast Container for Notifications -->
    <div id="toast-container" class="toast-container" role="alert" aria-live="polite"></div>

    <!-- Sound Toggle Button -->
    <button id="sound-toggle" class="sound-toggle" aria-label="Toggle sound effects" title="Toggle sound effects">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
        </svg>
    </button>

    <!-- Header -->
    <header class="bg-gray-900/80 backdrop-blur-md sticky top-0 z-50 shadow-lg shadow-indigo-900/10" role="banner">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8" aria-label="Main navigation">
            <div class="flex items-center justify-between h-16 sm:h-20">
                <!-- Logo -->
                <a href="index.html" class="flex items-center space-x-3 group" aria-label="LootBox Home">
                    <svg class="h-8 w-8 sm:h-10 sm:w-10 text-indigo-500 group-hover:text-indigo-400 transition-colors" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M21 8.25L12 3L3 8.25V15.75L12 21L21 15.75V8.25Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                        <path d="M12 15.75L21 11.25M12 15.75L3 11.25M12 15.75V21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16.5 6.375L7.5 11.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 3V9" stroke="#d4af37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-xl sm:text-2xl font-bold text-white">Loot<span class="text-indigo-400">Box</span></span>
                </a>

                <!-- Continue Shopping Link -->
                <a href="index.html" class="btn-secondary py-2 px-4 sm:px-6 rounded-lg text-sm sm:text-base flex items-center space-x-2 group" aria-label="Continue shopping">
                    <svg class="w-4 h-4 sm:w-5 sm:h-5 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    <span class="hidden sm:inline">Continue Shopping</span>
                    <span class="sm:hidden">Shop</span>
                </a>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12 flex-1" role="main">
        <!-- Page Title with Cart Count -->
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8 gap-4">
            <div>
                <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-gradient tracking-wide">Shopping Cart</h1>
                <p id="cart-count-text" class="text-gray-400 text-sm sm:text-base mt-1">0 items in your cart</p>
            </div>
            <!-- Breadcrumb -->
            <nav aria-label="Breadcrumb" class="text-sm text-gray-500">
                <ol class="flex items-center space-x-2">
                    <li><a href="index.html" class="hover:text-indigo-400 transition-colors">Home</a></li>
                    <li aria-hidden="true">/</li>
                    <li class="text-gray-300" aria-current="page">Cart</li>
                </ol>
            </nav>
        </div>

        <!-- Empty Cart Message -->
        <div id="empty-cart" class="hidden animate-fade-in">
            <div class="text-center py-12 sm:py-20 max-w-md mx-auto">
                <div class="relative inline-block mb-8">
                    <!-- Animated glow effects -->
                    <div class="absolute inset-0 bg-indigo-500/30 rounded-full blur-3xl animate-pulse"></div>
                    <div class="absolute inset-4 bg-purple-500/20 rounded-full blur-2xl" style="animation: pulse 3s ease-in-out infinite 0.5s;"></div>
                    <!-- Sparkles -->
                    <div class="empty-cart-sparkle"></div>
                    <div class="empty-cart-sparkle"></div>
                    <div class="empty-cart-sparkle"></div>
                    <div class="empty-cart-sparkle"></div>
                    <!-- Animated cart icon -->
                    <svg class="empty-cart-icon relative w-28 h-28 sm:w-36 sm:h-36 mx-auto text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <defs>
                            <linearGradient id="cartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
                                <stop offset="50%" style="stop-color:#8b5cf6;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#a855f7;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <path stroke="url(#cartGradient)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-gradient mb-3">Your cart is empty</h2>
                <p class="text-gray-400 mb-8 text-sm sm:text-base leading-relaxed">Looks like you haven't added anything to your cart yet.<br/>Discover premium PC parts and peripherals!</p>
                <a href="index.html" class="btn-glow py-4 px-10 rounded-xl inline-flex items-center space-x-3 text-base group" aria-label="Start shopping now">
                    <svg class="w-5 h-5 group-hover:rotate-12 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                    </svg>
                    <span>Explore Products</span>
                    <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                    </svg>
                </a>
            </div>
        </div>

        <!-- Cart Content -->
        <div id="cart-content" class="hidden">
            <!-- Cart Value Meter -->
            <div class="cart-meter mb-6">
                <div class="flex items-center justify-between mb-3">
                    <span class="text-sm text-gray-400">Cart Value</span>
                    <span id="cart-value-meter" class="meter-value">0</span>
                </div>

            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8">
                <!-- Cart Items Section -->
                <section class="lg:col-span-2" aria-labelledby="cart-items-heading">
                    <h2 id="cart-items-heading" class="sr-only">Cart Items</h2>

                    <!-- Cart Header Info Bar -->
                    <div class="cart-header-info flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 text-sm">
                        <div class="flex items-center space-x-2">
                            <svg class="w-5 h-5 text-green-400 animate-bounce" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span class="text-gray-300">Free shipping on all orders!</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                            <span class="text-gray-400">Secure checkout</span>
                        </div>
                    </div>

                    <!-- Loading Skeleton (shown while loading) -->
                    <div id="cart-skeleton" class="space-y-4 hidden">
                        <div class="skeleton-card">
                            <div class="skeleton skeleton-img"></div>
                            <div class="flex-1">
                                <div class="skeleton skeleton-text medium"></div>
                                <div class="skeleton skeleton-text short"></div>
                                <div class="skeleton skeleton-price mt-4"></div>
                            </div>
                        </div>
                        <div class="skeleton-card">
                            <div class="skeleton skeleton-img"></div>
                            <div class="flex-1">
                                <div class="skeleton skeleton-text medium"></div>
                                <div class="skeleton skeleton-text short"></div>
                                <div class="skeleton skeleton-price mt-4"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Cart Items List -->
                    <div id="cart-items" class="space-y-4" role="list" aria-label="Cart items"></div>

                    <!-- Recently Removed Section -->
                    <div id="recently-removed" class="recently-removed hidden" role="region" aria-label="Recently removed items">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                                <span class="text-sm text-gray-400">Recently removed: <span id="removed-item-name" class="text-gray-300"></span></span>
                            </div>
                            <button onclick="undoRemove()" class="undo-btn">Undo</button>
                        </div>
                    </div>

                    <!-- Clear Cart Button -->
                    <div class="mt-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
                        <button onclick="clearCart()" class="btn-delete flex items-center space-x-2 text-sm group" aria-label="Clear all items from cart">
                            <svg class="w-5 h-5 group-hover:animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                            <span>Clear Cart</span>
                        </button>
                        <a href="index.html" class="text-indigo-400 hover:text-indigo-300 transition-colors text-sm flex items-center space-x-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            <span>Add more items</span>
                        </a>
                    </div>
                </section>

                <!-- Order Summary Section -->
                <aside class="lg:col-span-1" aria-labelledby="order-summary-heading">
                    <div class="summary-card rounded-2xl p-5 sm:p-6 sticky top-24">
                        <h2 id="order-summary-heading" class="text-lg sm:text-xl font-semibold text-gradient mb-5">Order Summary</h2>

                        <!-- Summary Details -->
                        <div class="space-y-3 mb-5 text-sm sm:text-base">
                            <div class="flex justify-between text-gray-400">
                                <span>Subtotal (<span id="item-count">0</span> items)</span>
                                <span id="subtotal" class="text-gray-200">0</span>
                            </div>
                            <div class="flex justify-between text-gray-400">
                                <span>Shipping</span>
                                <span class="text-green-400 font-medium">FREE</span>
                            </div>
                            <div class="flex justify-between text-gray-400">
                                <span>Estimated Tax</span>
                                <span class="text-gray-300">0</span>
                            </div>
                        </div>

                        <!-- Promo Code Section -->
                        <div class="border-t border-gray-700/50 pt-4 mb-4">
                            <label for="promo-code" class="block text-sm text-gray-400 mb-2">Promo Code</label>
                            <div class="flex gap-2 promo-flex">
                                <input type="text" id="promo-code" class="promo-input flex-1 min-w-0" placeholder="Enter code" aria-describedby="promo-help" autocomplete="off">
                                <button onclick="applyPromo()" class="btn-secondary px-4 py-2 rounded-lg text-sm whitespace-nowrap" aria-label="Apply promo code">Apply</button>
                            </div>
                            <p id="promo-help" class="text-xs text-gray-500 mt-2">Try: LOOTBOX10, WELCOME</p>
                        </div>

                        <!-- Savings Display -->
                        <div id="savings-display" class="savings-display hidden mb-4">
                            <svg class="w-5 h-5 text-green-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <p class="text-xs text-gray-400">You saved</p>
                                <p id="savings-amount" class="text-green-400 font-bold">0</p>
                            </div>
                        </div>

                        <!-- Total -->
                        <div class="border-t border-gray-700/50 pt-4 mb-4">
                            <div class="flex justify-between items-center">
                                <span class="text-white text-base sm:text-lg font-semibold">Total</span>
                                <span id="total" class="price-glow text-xl sm:text-2xl font-bold">0</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1">VAT included where applicable</p>
                        </div>

                        <!-- Estimated Delivery -->
                        <div class="delivery-date mb-5">
                            <svg class="w-5 h-5 text-green-400 calendar-icon flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <div>
                                <p class="text-xs text-gray-400">Estimated Delivery</p>
                                <p id="delivery-date" class="text-green-400 text-sm font-semibold"></p>
                            </div>
                        </div>

                        <!-- Checkout Button -->
                        <button onclick="checkout()" id="checkout-btn" class="w-full btn-glow py-4 px-6 rounded-xl text-base sm:text-lg flex items-center justify-center space-x-3 group" aria-label="Proceed to checkout">
                            <svg class="w-5 h-5 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                            <span>Proceed to Checkout</span>
                            <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
                            </svg>
                        </button>

                        <!-- Trust Badges -->
                        <div class="mt-5 pt-4 border-t border-gray-700/30">
                            <div class="flex items-center justify-center space-x-4 text-xs text-gray-500">
                                <div class="flex items-center space-x-1">
                                    <svg class="w-4 h-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                                    </svg>
                                    <span>Secure</span>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <svg class="w-4 h-4 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                    <span>Cards Accepted</span>
                                </div>
                            </div>
                            <p class="text-gray-500 text-xs text-center mt-3">Powered by LootBox &bull; Fast & Secure</p>
                        </div>
                    </div>
                </aside>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 border-t border-gray-800" role="contentinfo">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <a href="index.html" class="flex items-center space-x-3">
                        <svg class="h-8 w-8 text-indigo-500" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 8.25L12 3L3 8.25V15.75L12 21L21 15.75V8.25Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/><path d="M12 15.75L21 11.25M12 15.75L3 11.25M12 15.75V21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M16.5 6.375L7.5 11.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 3V9" stroke="#d4af37" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                        <span class="text-xl font-bold text-white">Loot<span class="text-indigo-400">Box</span></span>
                    </a>
                    <p class="mt-4 text-gray-400 text-sm">Your one-stop shop for high-performance PC hardware.</p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-300 tracking-wider uppercase">Shop</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="index.html#components" class="text-base text-gray-400 hover:text-white transition-colors">Components</a></li>
                        <li><a href="index.html#peripherals" class="text-base text-gray-400 hover:text-white transition-colors">Peripherals</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-sm font-semibold text-gray-300 tracking-wider uppercase">Company</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="index.html#about" class="text-base text-gray-400 hover:text-white transition-colors">About</a></li>
                        <li><a href="index.html#contact" class="text-base text-gray-400 hover:text-white transition-colors">Contact</a></li>
                    </ul>
                </div>
                 <div>
                    <h3 class="text-sm font-semibold text-gray-300 tracking-wider uppercase">Connect</h3>
                     <div class="flex mt-4 space-x-6">
                        <!-- Social Icons -->
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><span class="sr-only">Twitter</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors"><span class="sr-only">GitHub</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.165 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z" clip-rule="evenodd"></path></svg></a>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-800 pt-8 text-center text-sm text-gray-500">
                <p>&copy; 2024 LootBox Technologies. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Mobile Sticky Checkout Bar -->
    <div id="mobile-checkout-bar" class="mobile-checkout-bar" role="complementary" aria-label="Mobile checkout">
        <div class="flex items-center justify-between gap-4">
            <div class="flex-1 min-w-0">
                <p class="text-xs text-gray-400">Total</p>
                <p id="mobile-total" class="price-glow text-lg font-bold truncate">0</p>
            </div>
            <button onclick="checkout()" class="btn-glow py-3 px-6 rounded-xl text-sm font-semibold flex items-center space-x-2 flex-shrink-0" aria-label="Proceed to checkout">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
                <span>Checkout</span>
            </button>
        </div>
    </div>

    <script>
        // ==================== SOUND EFFECTS ====================
        let soundEnabled = false;
        const sounds = {
            pop: null,
            success: null,
            remove: null,
            checkout: null
        };

        // Initialize sound toggle
        document.getElementById('sound-toggle').addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            this.classList.toggle('active', soundEnabled);
            if (soundEnabled) {
                showToast('Sound effects enabled ', 'info', 2000);
            }
        });

        function playSound(type) {
            if (!soundEnabled) return;
            // Create simple oscillator-based sounds
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            switch(type) {
                case 'pop':
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                case 'success':
                    oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                    oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                case 'remove':
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.15);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
            }
        }

        // ==================== CONFETTI EFFECT ====================
        function createConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const colors = ['#4f46e5', '#8b5cf6', '#d4af37', '#10b981', '#f59e0b', '#ef4444', '#00f0ff'];

            for (let i = 0; i < 150; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    size: Math.random() * 10 + 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    speed: Math.random() * 3 + 2,
                    angle: Math.random() * Math.PI * 2,
                    rotation: Math.random() * 0.2 - 0.1,
                    rotationAngle: 0
                });
            }

            let frame = 0;
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                particles.forEach((p, index) => {
                    p.y += p.speed;
                    p.x += Math.sin(p.angle) * 2;
                    p.rotationAngle += p.rotation;

                    ctx.save();
                    ctx.translate(p.x, p.y);
                    ctx.rotate(p.rotationAngle);
                    ctx.fillStyle = p.color;
                    ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size * 0.6);
                    ctx.restore();
                });

                frame++;
                if (frame < 180) {
                    requestAnimationFrame(animate);
                } else {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            }
            animate();
        }

        // ==================== FLOATING PARTICLES ====================
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                container.appendChild(particle);
            }
        }
        createParticles();

        // ==================== RIPPLE EFFECT ====================
        function createRipple(event, element) {
            const ripple = document.createElement('span');
            const rect = element.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);

            ripple.style.width = ripple.style.height = size + 'px';
            ripple.style.left = (event.clientX - rect.left - size / 2) + 'px';
            ripple.style.top = (event.clientY - rect.top - size / 2) + 'px';
            ripple.className = 'ripple';

            element.appendChild(ripple);
            setTimeout(() => ripple.remove(), 600);
        }

        // Add ripple to buttons
        document.addEventListener('click', function(e) {
            if (e.target.matches('.btn-glow, .btn-secondary, .qty-btn')) {
                createRipple(e, e.target);
            }
        });

        // ==================== ENHANCED TOAST NOTIFICATION ====================
        function showToast(message, type = 'info', duration = 3000, title = null) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const icons = {
                success: `<div class="toast-icon"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>`,
                error: `<div class="toast-icon"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></div>`,
                info: `<div class="toast-icon"><svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>`
            };

            const titles = {
                success: title || 'Success!',
                error: title || 'Error',
                info: title || 'Info'
            };

            toast.innerHTML = `
                ${icons[type] || icons.info}
                <div class="toast-content">
                    <p class="toast-title">${titles[type]}</p>
                    <p class="toast-message">${message}</p>
                </div>
                <button onclick="this.parentElement.remove()" class="text-gray-400 hover:text-white transition-colors p-1" aria-label="Close notification">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <div class="toast-progress"></div>`;

            container.appendChild(toast);

            // Play sound based on type
            if (type === 'success') playSound('success');

            setTimeout(() => {
                toast.classList.add('exit');
                setTimeout(() => toast.remove(), 400);
            }, duration);
        }

        // ==================== CART DATA MANAGEMENT ====================
        let recentlyRemovedItem = null;
        let currentDiscount = 0;
        let appliedPromoCode = null;

        const cart = {
            items: JSON.parse(localStorage.getItem('lootbox_cart')) || [],

            save() {
                localStorage.setItem('lootbox_cart', JSON.stringify(this.items));
            },

            removeItem(productName) {
                const item = this.items.find(i => i.name === productName);
                if (item) {
                    recentlyRemovedItem = { ...item };
                    this.items = this.items.filter(i => i.name !== productName);
                    this.save();
                    playSound('remove');

                    // Shake cart icon animation
                    const header = document.querySelector('header');
                    header.style.animation = 'shake 0.5s ease-in-out';
                    setTimeout(() => header.style.animation = '', 500);

                    // Show recently removed section
                    showRecentlyRemoved(item.name);

                    renderCart();
                    showToast(`${item.name} removed from cart`, 'info', 3000, 'Item Removed');
                }
            },

            updateQuantity(productName, quantity) {
                const item = this.items.find(i => i.name === productName);
                if (item) {
                    const oldQty = item.quantity;
                    item.quantity = Math.max(1, Math.min(99, quantity));
                    this.save();
                    playSound('pop');
                    renderCart(false);

                    // Animate the quantity button
                    const card = document.querySelector(`[data-product="${productName}"]`);
                    if (card) {
                        card.classList.add('bounce');
                        setTimeout(() => card.classList.remove('bounce'), 500);
                    }
                }
            },

            getTotal() {
                return this.items.reduce((total, item) => {
                    const price = parseFloat(item.price.replace(/[,]/g, ''));
                    return total + (price * item.quantity);
                }, 0);
            },

            getTotalItems() {
                return this.items.reduce((total, item) => total + item.quantity, 0);
            },

            getItemLineTotal(item) {
                const price = parseFloat(item.price.replace(/[,]/g, ''));
                return price * item.quantity;
            },

            clear() {
                this.items = [];
                this.save();
                renderCart();
                showToast('Cart cleared', 'info', 3000, 'Cart Empty');
            }
        };

        // ==================== RECENTLY REMOVED ====================
        function showRecentlyRemoved(itemName) {
            const section = document.getElementById('recently-removed');
            const nameSpan = document.getElementById('removed-item-name');
            if (section && nameSpan) {
                nameSpan.textContent = itemName;
                section.classList.remove('hidden');
                // Auto-hide after 10 seconds
                setTimeout(() => {
                    section.classList.add('hidden');
                    recentlyRemovedItem = null;
                }, 10000);
            }
        }

        function undoRemove() {
            if (recentlyRemovedItem) {
                cart.items.push(recentlyRemovedItem);
                cart.save();
                playSound('success');
                showToast(`${recentlyRemovedItem.name} restored to cart!`, 'success', 3000, 'Item Restored');
                recentlyRemovedItem = null;
                document.getElementById('recently-removed').classList.add('hidden');
                renderCart();
            }
        }

        // ==================== FORMAT CURRENCY ====================
        function formatCurrency(amount) {
            return '' + amount.toLocaleString('en-PH', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        }

        // ==================== RENDER CART ====================
        function renderCart(animate = true) {
            const emptyCart = document.getElementById('empty-cart');
            const cartContent = document.getElementById('cart-content');
            const cartItemsContainer = document.getElementById('cart-items');
            const cartCountText = document.getElementById('cart-count-text');
            const itemCount = document.getElementById('item-count');

            // Update cart count text
            const totalItems = cart.getTotalItems();
            cartCountText.textContent = `${totalItems} ${totalItems === 1 ? 'item' : 'items'} in your cart`;
            if (itemCount) itemCount.textContent = totalItems;

            // Handle mobile checkout bar visibility
            const mobileBar = document.getElementById('mobile-checkout-bar');

            if (cart.items.length === 0) {
                emptyCart.classList.remove('hidden');
                cartContent.classList.add('hidden');
                document.getElementById('checkout-btn').disabled = true;
                if (mobileBar) mobileBar.style.display = 'none';
                return;
            }

            emptyCart.classList.add('hidden');
            cartContent.classList.remove('hidden');
            document.getElementById('checkout-btn').disabled = false;

            // Get random badges for items
            const badges = ['popular', 'bestseller', 'limited', null, null, null]; // Some items won't have badges

            // Generate fake ratings
            const getStars = () => {
                const rating = (Math.random() * 1.5 + 3.5).toFixed(1); // 3.5 to 5.0
                const fullStars = Math.floor(rating);
                const hasHalf = rating - fullStars >= 0.5;
                let stars = '';
                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        stars += '';
                    } else if (i === fullStars && hasHalf) {
                        stars += '';
                    } else {
                        stars += '<span class="star empty"></span>';
                    }
                }
                return `<span class="stars text-yellow-400 text-xs">${stars}</span><span class="text-gray-500 text-xs ml-1">(${Math.floor(Math.random() * 200 + 50)})</span>`;
            };

            // Render cart items with enhanced design
            cartItemsContainer.innerHTML = cart.items.map((item, index) => {
                const lineTotal = cart.getItemLineTotal(item);
                const escapedName = item.name.replace(/'/g, "\\'");
                const animationDelay = animate ? `animation-delay: ${index * 0.05}s` : '';
                const badge = badges[Math.floor(Math.random() * badges.length)];
                const badgeHtml = badge ? `<span class="badge badge-${badge} ml-2">${badge === 'popular' ? ' Popular' : badge === 'bestseller' ? ' Best Seller' : ' Limited'}</span>` : '';

                return `
                <div class="cart-card cart-item rounded-xl p-4 sm:p-5 loaded" style="${animationDelay}" role="listitem" data-product="${escapedName}">
                    <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4">
                        <!-- Product Image with zoom -->
                        <div class="img-zoom-container flex-shrink-0 self-center sm:self-auto">
                            <img src="${item.image}"
                                 alt="${item.name}"
                                 class="cart-img w-20 h-20 sm:w-24 sm:h-24 object-cover"
                                 loading="lazy"
                                 onerror="this.src='https://placehold.co/100x100/1f2937/6366f1?text=Product';">
                        </div>

                        <!-- Product Details -->
                        <div class="flex-1 min-w-0 text-center sm:text-left w-full sm:w-auto">
                            <div class="flex items-center justify-center sm:justify-start flex-wrap">
                                <h3 class="text-base sm:text-lg font-semibold text-white truncate">${item.name}</h3>
                                ${badgeHtml}
                            </div>
                            <p class="text-gray-400 text-xs sm:text-sm font-light mt-1 line-clamp-2">${item.description || 'Premium quality product'}</p>
                            <div class="flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3 mt-2">
                                <span class="price-glow font-semibold text-sm sm:text-base">${item.price}</span>
                                <span class="text-gray-500 text-xs hidden sm:inline">each</span>
                                <span class="hidden sm:inline">${getStars()}</span>
                            </div>
                        </div>

                        <!-- Quantity Controls & Actions -->
                        <div class="flex items-center justify-between sm:justify-end gap-4 sm:gap-6 w-full sm:w-auto mt-2 sm:mt-0">
                            <!-- Quantity Selector -->
                            <div class="flex items-center space-x-2 sm:space-x-3" role="group" aria-label="Quantity controls for ${item.name}">
                                <button onclick="updateQty('${escapedName}', ${item.quantity - 1})"
                                        class="qty-btn w-8 h-8 sm:w-9 sm:h-9 rounded-lg text-white text-lg font-medium"
                                        aria-label="Decrease quantity"
                                        ${item.quantity <= 1 ? 'disabled' : ''}></button>
                                <input type="number"
                                       value="${item.quantity}"
                                       min="1"
                                       max="99"
                                       class="qty-input w-12 text-center bg-transparent text-white font-semibold border-0 focus:ring-2 focus:ring-indigo-500 rounded"
                                       onchange="updateQtyFromInput('${escapedName}', this.value)"
                                       aria-label="Quantity for ${item.name}"
                                       inputmode="numeric"
                                       pattern="[0-9]*">
                                <button onclick="updateQty('${escapedName}', ${item.quantity + 1})"
                                        class="qty-btn w-8 h-8 sm:w-9 sm:h-9 rounded-lg text-white text-lg font-medium"
                                        aria-label="Increase quantity"
                                        ${item.quantity >= 99 ? 'disabled' : ''}>+</button>
                            </div>

                            <!-- Line Total (Desktop) -->
                            <div class="hidden sm:block text-right min-w-[100px]">
                                <span class="text-xs text-gray-500 block">Subtotal</span>
                                <span class="line-total text-base font-semibold">${formatCurrency(lineTotal)}</span>
                            </div>

                            <!-- Remove Button -->
                            <button onclick="removeItem('${escapedName}')"
                                    class="btn-delete"
                                    aria-label="Remove ${item.name} from cart">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Line Total (Mobile) -->
                    <div class="sm:hidden mt-3 pt-3 border-t border-gray-700/30 flex justify-between items-center">
                        <span class="text-xs text-gray-400">Item Total</span>
                        <span class="line-total text-base font-semibold">${formatCurrency(lineTotal)}</span>
                    </div>
                </div>`;
            }).join('');

            // Update totals
            updateTotals();
        }

        // ==================== UPDATE TOTALS ====================
        function updateTotals() {
            const subtotal = cart.getTotal();
            const discount = currentDiscount > 0 ? subtotal * (currentDiscount / 100) : 0;
            const total = subtotal - discount;
            const formattedTotal = formatCurrency(total);

            document.getElementById('subtotal').textContent = formatCurrency(subtotal);
            document.getElementById('total').textContent = formattedTotal;

            // Update cart value meter
            const meterValue = document.getElementById('cart-value-meter');
            if (meterValue) {
                meterValue.textContent = formattedTotal;
            }

            // Update savings display
            const savingsDisplay = document.getElementById('savings-display');
            const savingsAmount = document.getElementById('savings-amount');
            if (savingsDisplay && savingsAmount) {
                if (discount > 0) {
                    savingsDisplay.classList.remove('hidden');
                    savingsAmount.textContent = formatCurrency(discount);
                } else {
                    savingsDisplay.classList.add('hidden');
                }
            }

            // Update estimated delivery date
            const deliveryDate = document.getElementById('delivery-date');
            if (deliveryDate) {
                const today = new Date();
                const delivery = new Date(today);
                delivery.setDate(today.getDate() + (subtotal >= premiumThreshold ? 2 : 5));
                const options = { weekday: 'short', month: 'short', day: 'numeric' };
                deliveryDate.textContent = delivery.toLocaleDateString('en-US', options);
            }

            // Update mobile checkout bar total
            const mobileTotal = document.getElementById('mobile-total');
            if (mobileTotal) {
                mobileTotal.textContent = formattedTotal;
            }

            // Show/hide mobile checkout bar based on cart state
            const mobileBar = document.getElementById('mobile-checkout-bar');
            if (mobileBar) {
                if (cart.items.length > 0) {
                    mobileBar.style.display = 'block';
                } else {
                    mobileBar.style.display = 'none';
                }
            }
        }

        // ==================== QUANTITY FUNCTIONS ====================
        function updateQty(name, quantity) {
            if (quantity < 1) {
                removeItem(name);
            } else {
                cart.updateQuantity(name, quantity);
            }
        }

        function updateQtyFromInput(name, value) {
            const quantity = parseInt(value, 10);
            if (!isNaN(quantity) && quantity >= 1) {
                cart.updateQuantity(name, quantity);
            } else {
                renderCart(false);
            }
        }

        // Add pop animation to quantity buttons
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('qty-btn') && !e.target.disabled) {
                e.target.classList.add('pop');
                setTimeout(() => e.target.classList.remove('pop'), 400);
            }
        });

        // ==================== REMOVE ITEM ====================
        function removeItem(name) {
            // Find the card element and animate it out
            const card = document.querySelector(`[data-product="${name.replace(/'/g, "\\'")}"]`);
            if (card) {
                card.style.transition = 'all 0.3s ease';
                card.style.transform = 'translateX(100%)';
                card.style.opacity = '0';
                setTimeout(() => cart.removeItem(name), 300);
            } else {
                cart.removeItem(name);
            }
        }

        // ==================== CLEAR CART ====================
        function clearCart() {
            if (cart.items.length === 0) {
                showToast('Your cart is already empty', 'info');
                return;
            }

            // Show custom confirmation
            const confirmed = confirm('Are you sure you want to clear your entire cart? This action cannot be undone.');
            if (confirmed) {
                cart.clear();
            }
        }

        // ==================== PROMO CODE ====================
        function applyPromo() {
            const promoInput = document.getElementById('promo-code');
            const code = promoInput.value.trim().toUpperCase();

            if (!code) {
                showToast('Please enter a promo code', 'error');
                return;
            }

            // Demo promo codes
            const promoCodes = {
                'LOOTBOX10': { discount: 10, message: '10% discount applied!' },
                'WELCOME': { discount: 5, message: '5% welcome discount applied!' },
                'FREESHIP': { discount: 0, message: 'Free shipping already included!' },
                'SAVE20': { discount: 20, message: '20% mega discount applied!' }
            };

            if (appliedPromoCode === code) {
                showToast('This promo code is already applied!', 'info', 2000, 'Already Applied');
                return;
            }

            if (promoCodes[code]) {
                appliedPromoCode = code;
                currentDiscount = promoCodes[code].discount;
                playSound('success');
                showToast(promoCodes[code].message, 'success', 3000, ' Promo Applied!');
                promoInput.value = '';
                promoInput.disabled = true;
                promoInput.placeholder = code + ' applied!';
                updateTotals();
            } else {
                showToast('Invalid promo code. Try LOOTBOX10 or WELCOME!', 'error', 3000, 'Invalid Code');
            }
        }

        // ==================== CHECKOUT ====================
        function checkout() {
            if (cart.items.length === 0) {
                showToast('Your cart is empty', 'error', 2000, 'Empty Cart');
                return;
            }

            const btn = document.getElementById('checkout-btn');
            btn.disabled = true;
            btn.innerHTML = '<svg class="animate-spin w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing...';

            setTimeout(() => {
                // Trigger confetti celebration!
                createConfetti();
                playSound('success');

                btn.disabled = false;
                btn.innerHTML = `<svg class="w-5 h-5 group-hover:scale-110 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg><span>Proceed to Checkout</span><svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg>`;
                showToast(' Checkout functionality coming soon! Thank you for shopping at LootBox.', 'success', 4000, 'Almost There!');
            }, 1500);
        }

        // ==================== KEYBOARD NAVIGATION ====================
        document.addEventListener('keydown', function(e) {
            // Allow Enter key to trigger buttons
            if (e.key === 'Enter' && e.target.tagName === 'BUTTON') {
                e.target.click();
            }
            // Allow Enter key on promo input to apply code
            if (e.key === 'Enter' && e.target.id === 'promo-code') {
                applyPromo();
            }
        });

        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', function() {
            renderCart();

            // Add smooth page load animation
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.3s ease';
            setTimeout(() => document.body.style.opacity = '1', 50);
        });
    </script>
</body>
</html>

